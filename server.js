const express = require('express'); const mongoose = require('mongoose'); const jwt = require('jsonwebtoken'); const nodemailer = require('nodemailer'); const app = express(); app.use(express.json()); mongoose.connect('mongodb://localhost:27017/myapp', { useNewUrlParser: true, useUnifiedTopology: true }); const UserSchema = new mongoose.Schema({ email: String, password: String }); const TaskSchema = new mongoose.Schema({ title: String, description: String, due_date: Date, status: String }); const User = mongoose.model('User', UserSchema); const Task = mongoose.model('Task', TaskSchema); app.post('/api/auth/register', async (req, res) => { const user = new User(req.body); await user.save(); res.json({ status: 'success', message: 'User registered' }); }); app.post('/api/auth/login', async (req, res) => { const user = await User.findOne(req.body); if (user) { const token = jwt.sign({ id: user._id }, 'secret'); res.json({ status: 'success', token }); } else { res.json({ status: 'error', message: 'Invalid credentials' }); } }); app.post('/api/tasks', async (req, res) => { const task = new Task(req.body); await task.save(); res.json({ status: 'success', task_id: task._id }); }); app.get('/api/tasks', async (req, res) => { const tasks = await Task.find(); res.json(tasks); }); app.put('/api/tasks/:task_id', async (req, res) => { await Task.findByIdAndUpdate(req.params.task_id, req.body); res.json({ status: 'success' }); }); app.delete('/api/tasks/:task_id', async (req, res) => { await Task.findByIdAndDelete(req.params.task_id); res.json({ status: 'success' }); }); app.patch('/api/tasks/:task_id/status', async (req, res) => { await Task.findByIdAndUpdate(req.params.task_id, { status: req.body.status }); res.json({ status: 'success' }); }); app.get('/api/notifications/preferences', (req, res) => { res.json({ email_notifications: true, in_app_notifications: true }); }); app.put('/api/notifications/preferences', (req, res) => { res.json({ status: 'success' }); }); app.listen(3000, () => { console.log('Server running on port 3000'); });